<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="|Chi ti·∫øt Sinh vi√™n: ${student.studentName}|"></title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
  <h1 class="mb-4 text-success">Chi ti·∫øt Sinh vi√™n: <span th:text="${student.studentName}"></span></h1>

  <div th:if="${message}" class="alert alert-success" role="alert">
    <span th:text="${message}">Thao t√°c th√†nh c√¥ng!</span>
  </div>
  <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
    <span th:text="${errorMessage}">Thao t√°c th·∫•t b·∫°i!</span>
  </div>

  <div th:if="${summary.hasScores}">
    <h2 class="mt-4 text-primary">Dashboard H·ªçc l·ª±c</h2>

    <div class="card shadow mb-4">
      <div class="card-header bg-primary text-white">
        <h5>T·ªïng quan ƒê√°nh gi√° H·ªçc t·∫≠p</h5>
      </div>
      <div class="card-body">
        <div class="row text-center">

          <div class="col-md-4 mb-3">
            <div class="h5 text-secondary">ƒêi·ªÉm Trung b√¨nh (GPA)</div>
            <div class="display-4 text-primary" th:text="${summary.gpa}">N/A</div>
          </div>

          <div class="col-md-4 mb-3">
            <div class="h5 text-secondary">Tr·∫°ng th√°i Hi·ªán t·∫°i</div>
            <div th:classappend="${summary.status == 'Xu·∫•t s·∫Øc' ? 'text-success' :
                                  (summary.status == 'Gi·ªèi' ? 'text-info' :
                                  (summary.status == 'Kh√°' ? 'text-warning' :
                                  (summary.status == 'Trung b√¨nh' ? 'text-secondary' : 'text-danger')))}"
                 th:text="${summary.status}" class="display-4">N/A</div>
          </div>

          <div class="col-md-4 mb-3">
            <div class="h5 text-secondary">T·ªïng s·ªë m√¥n ƒë√£ ch·∫•m</div>
            <div class="display-4 text-info" th:text="${summary.totalSubjects}">0</div>
          </div>
        </div>
      </div>
    </div>

    <div th:classappend="${summary.status == 'K√©m' || summary.status == 'Y·∫øu' ? 'alert-danger' : 'alert-info'}" class="alert shadow-sm" role="alert">
      <h5 th:text="${summary.status == 'K√©m' || summary.status == 'Y·∫øu' ? 'üö® C·∫¢NH B√ÅO H·ªåC T·∫¨P' : 'üí° L·ªúI KHUY√äN C√Å NH√ÇN'}" class="alert-heading">L·ªùi khuy√™n</h5>
      <p th:text="${summary.reminder}">Kh√¥ng c√≥ l·ªùi nh·∫Øc nh·ªü c·ª• th·ªÉ.</p>
    </div>

    <hr class="my-5"/>
  </div>
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-success text-white">
      <h5>Th√¥ng tin c√° nh√¢n</h5>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <p><strong>ID:</strong> <span th:text="${student.studentId}">1</span></p>
          <p><strong>T√™n Sinh vi√™n:</strong> <span th:text="${student.studentName}"></span></p>
          <p><strong>Email:</strong> <span th:text="${student.email}">a@gmail.com</span></p>
        </div>
        <div class="col-md-6">
          <p><strong>SƒêT:</strong> <span th:text="${student.sdt}">0912345678</span></p>
          <p><strong>Chuy√™n ng√†nh:</strong> <span th:text="${student.chuyenNganh}">N/A</span></p>
          <p><strong>ID L·ªõp h·ªçc (Kh√≥a ngo·∫°i):</strong> <span th:text="${student.idClass}">1</span></p>
        </div>
      </div>

      <div class="mt-3">
        <a th:href="@{/students/edit/{id}(id=${student.studentId})}" class="btn btn-sm btn-primary">
          ‚úèÔ∏è S·ª≠a th√¥ng tin Sinh vi√™n
        </a>
      </div>
    </div>
  </div>

  <h2 class="mt-4 text-info">Th√¥ng tin L·ªõp h·ªçc</h2>
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div th:if="${student.classInfo != null}" th:object="${student.classInfo}">
        <div class="row">
          <div class="col-md-6">
            <p><strong>ID L·ªõp:</strong> <span th:text="*{idClass}">1</span></p>
            <p><strong>T√™n L·ªõp:</strong> <span th:text="*{className}">CNTT1</span></p>
            <p><strong>Kh√≥a h·ªçc:</strong> <span th:text="*{khoaHoc}">Khoa CNTT</span></p>
          </div>
          <div class="col-md-6">
            <p><strong>Tr·∫°ng th√°i l·ªõp:</strong> <span th:text="*{trangThai}">ƒêang ho·∫°t ƒë·ªông</span></p>
            <p><strong>Ch·ªâ ti√™u SV:</strong> <span th:text="*{soLuongSinhVien}">20</span></p>
          </div>
        </div>
        <div class="mt-3">
          <a th:href="@{/classes/edit/{id}(id=*{idClass})}" class="btn btn-sm btn-info">
            ‚úèÔ∏è S·ª≠a L·ªõp h·ªçc n√†y
          </a>
        </div>
      </div>

      <p th:unless="${student.classInfo != null}" class="alert alert-warning text-dark">
        <i class="fas fa-exclamation-triangle"></i> H·ªá th·ªëng ƒëang s·∫Øp x·∫øp l·ªõp h·ªçc cho b·∫°n (Sinh vi√™n ch∆∞a ƒë∆∞·ª£c ph√¢n l·ªõp).
      </p>
    </div>
  </div>

  <h2 class="mt-4 text-warning">Danh s√°ch ƒêi·ªÉm</h2>
  <table class="table table-bordered table-hover">
    <thead class="table-warning">
    <tr>
      <th>ID ƒêi·ªÉm</th>
      <th>M√¥n h·ªçc</th>
      <th>ƒêi·ªÉm s·ªë</th>
      <th>ID Sinh vi√™n</th>
      <th>Ng√†y c·∫≠p nh·∫≠t</th>
      <th>H√†nh ƒë·ªông</th> </tr>
    </thead>
    <tbody>
    <tr th:each="diem : ${student.scores}">
      <td th:text="${diem.diemid}">1</td>
      <td th:text="${diem.monhoc}">CNTT</td>
      <td th:text="${diem.diem}">10.0</td>
      <td th:text="${diem.id}">1</td>
      <td th:text="${#dates.format(diem.ngayCapNhat, 'dd-MM-yyyy HH:mm')}">30-09-2025 10:30</td>

      <td>
        <a th:href="@{/diems/edit/{id}(id=${diem.diemid})}" class="btn btn-sm btn-warning">
          S·ª≠a ƒêi·ªÉm
        </a>
        <a th:href="@{/diems/delete/{diemId}(diemId=${diem.diemid})}"
           class="btn btn-sm btn-danger"
           onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ƒëi·ªÉm s·ªë n√†y kh√¥ng?');">
          X√≥a
        </a>
      </td>
    </tr>

    <tr th:if="${#lists.isEmpty(student.scores)}">
      <td colspan="6" class="text-center text-muted">Sinh vi√™n n√†y ch∆∞a c√≥ ƒëi·ªÉm n√†o.</td>
    </tr>
    </tbody>
  </table>

  <a th:href="@{/students/list}" class="btn btn-secondary mt-3">Quay l·∫°i danh s√°ch</a>
</div>
</body>
</html>