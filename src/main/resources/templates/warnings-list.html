<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Cảnh báo Học tập</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #f8f9fa; }
        .stat-card { border-left: 5px solid; }
        .stat-card.border-danger { border-color: #dc3545; }
        .stat-card.border-info { border-color: #0dcaf0; }
        .stat-card.border-success { border-color: #198754; }
    </style>
</head>
<body>
<div class="container mt-4 mb-5">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="text-danger"><i class="fas fa-exclamation-triangle me-2"></i> Dashboard Cảnh báo Học tập</h1>
        <a th:href="@{/students/list}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-2"></i> Quay lại Danh sách Sinh viên
        </a>
    </div>

    <!-- STATS DASHBOARD -->
    <div class="row g-4 mb-4">
        <div class="col-md-4">
            <div class="card shadow-sm stat-card border-info">
                <div class="card-body text-center">
                    <h6 class="card-title text-muted text-uppercase">Tổng số Sinh viên</h6>
                    <h2 class="card-text fw-bold display-4" th:text="${totalStudents}">0</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm stat-card border-danger">
                <div class="card-body text-center">
                    <h6 class="card-title text-muted text-uppercase">SV cần Cảnh báo</h6>
                    <h2 class="card-text fw-bold display-4 text-danger" th:text="${warningCount}">0</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm stat-card border-success">
                <div class="card-body text-center">
                    <h6 class="card-title text-muted text-uppercase">SV an toàn</h6>
                    <h2 class="card-text fw-bold display-4 text-success" th:text="${totalStudents - warningCount}">0</h2>
                </div>
            </div>
        </div>
    </div>

    <!-- WARNING LIST TABLE -->
    <div class="card shadow-sm">
        <div class="card-header bg-light">
            <h4 class="mb-0 text-primary"><i class="fas fa-list-ul me-2"></i>Danh sách Sinh viên cần theo dõi (GPA &lt; 5.5)</h4>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover table-striped mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>Tên Sinh viên</th>
                        <th>Lớp</th>
                        <th class="text-center">GPA</th>
                        <th class="text-center">Xếp loại</th>
                        <th>Môn cần cải thiện</th>
                        <th class="text-center">Hành động</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="warning : ${warnings}">
                        <td>
                            <div class="fw-bold" th:text="${warning.studentName}"></div>
                            <div class="small text-muted" th:text="'ID: ' + ${warning.studentId}"></div>
                        </td>
                        <td th:text="${warning.className}"></td>
                        <td class="text-center fw-bold" th:text="${warning.gpa}"></td>
                        <td class="text-center">
                                <span class="badge"
                                      th:classappend="${warning.status == 'Kém'} ? 'bg-danger' : 'bg-warning text-dark'"
                                      th:text="${warning.status}"></span>
                        </td>
                        <td th:text="${warning.subjectToImprove}"></td>
                        <td class="text-center">
                            <a th:href="@{/students/detail/{id}(id=${warning.studentId})}" class="btn btn-sm btn-primary">
                                <i class="fas fa-eye me-1"></i> Xem Chi tiết
                            </a>
                        </td>
                    </tr>
                    <tr th:if="${warnings.isEmpty()}">
                        <td colspan="6" class="text-center p-4">
                            <div class="text-success">
                                <i class="fas fa-check-circle fa-2x mb-2"></i>
                                <p class="fw-bold mb-0">Tuyệt vời! Không có sinh viên nào trong diện cảnh báo.</p>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
